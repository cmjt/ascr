---
title: "Report"
output: html_document
params:
  buffer: NA
  spacing: NA
  fit: NA
  anispeed: = NA
  dist: NA
---
```{r setup, eval = TRUE, echo = FALSE}
bear <- FALSE
distance <- FALSE
if(!is.null(params$fit$args$capt$bearing)){bear <- TRUE}
if(!is.null(params$fit$args$capt$dist)){distance <- TRUE}
```


The data included a total of `r nrow(params$fit$args$capt$bincapt)` calls and `r ncol(params$fit$args$capt$bincapt)` traps.

The mask used had a `r params$buffer` meter buffer and spacing of `r params$spacing` meters.

```{r plot mask,eval = TRUE,echo = FALSE}
plot.mask(params$fit$args$mask,params$fit$args$traps)
```


Parameter estimates and standard errors from the analysis. 
```{r}
params$fit
```

The detection surface is estimated as

```{r plot set.surf,eval=TRUE,echo=FALSE,warning=FALSE,message=FALSE}
show.detsurf(params$fit)
```

The detection function is estimated as 

```{r plot.detfn, eval=TRUE,echo=FALSE}
show.detfn(params$fit)
```

```{r bearing,eval = bear,results='asis',message = FALSE, echo = FALSE}
cat("The bearing distribution is estimated as")
```

```{r plot bear,eval = bear,echo = FALSE}
plot.dvm(params$fit)
```

```{r distance,eval = distance,results = 'asis',message = FALSE,echo = FALSE}
cat(paste("The distance distribution evaluated at",params$dist, "m is estimated as"))
```

```{r plot dist,eval = distance,echo = FALSE}
plot.distgam(params$fit)
```
The estimated locations of each call is shown in this animation

```{r animation, eval=TRUE,echo=FALSE,fig.show='animate',message=FALSE,fig.height=7,fig.width=7}
library(animation)
frames <- nrow(params$fit$args$capt$bincapt)
oopt = ani.options(interval = params$anispeed,loop = 1, nmax = frames,ani.width = 600,ani.height = 600)
out <- vector("list", frames)
for (i in 1:ani.options("nmax")) {
  locations(params$fit,i)
  legend("top",legend = paste("call",i,sep = " "),bty = "n")
  ani.pause()
  }

ani.options(oopt)

```